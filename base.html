<body>
<div id="app">
<div v-if="load">
    %s
</div>
</div>



   <script src="https://cdn.bootcdn.net/ajax/libs/vue/3.1.0/vue.global.js"></script>
   <script src="https://cdn.bootcdn.net/ajax/libs/axios/0.21.1/axios.min.js"></script>

    %s

    <script>
       var  win = window
   

       function formatData(code,datas){
            var name = datas[0]
            var close1 = datas[2]
            var close = datas[3]
            
            var rise = 100 * (close - close1) / close1
            if (String(parseFloat(rise)) != "NaN"){ //NaN 是无法直接比较的)
                rise = parseFloat(rise).toFixed(2)
            } else {
                rise = 0.000
            } 
            vue.$data.result[code]=[name,close,rise]
            console.log(name,close,rise)
       }
       

      async function getDatas(that){

        for (i=0 ; i < stocklist.length;i+=100){
            params = stocklist.slice(i,i+100).join()
            response = await axios.get(apihost+"/?list="+params)
        
            eval(response.data)
            console.log(response)
        }
        stocklist.forEach(function(item){

                  eval('win.'+item +'= hq_str_'+item)
                  var datas= win[item].split(',')

                  formatData(item,datas)

                })
         that.load = 1

      }


   var hostname = window.location.hostname
   var host = window.location.host
     if (hostname == ""){
        hostname = "127.0.0.1"
        apihost = "http://127.0.0.1:8000"
     } else {
        apihost = "http://"+host
     }
   
      const VueApp = {
        data() {
            return {
                load:0,
                result:{},
            }
        },
    
        created() {
            
        },

        mounted () {
           var that = this
            getDatas(that)
       },
        methods: {
        }
      }//VueApp
      window.vue = Vue.createApp(VueApp).mount('#app')

   </script>


</body>
